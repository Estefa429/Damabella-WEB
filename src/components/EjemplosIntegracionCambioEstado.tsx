/**\n * üìö EJEMPLOS DE INTEGRACI√ìN\n * \n * Este archivo contiene ejemplos listos para copiar-pegar en tus componentes.\n * Copiar solo la parte que necesites seg√∫n tu caso de uso.\n */\n\nimport { useState } from 'react';\nimport { useCambioEstadoPedido } from '../hooks/useCambioEstadoPedido';\nimport { cambiarEstadoPedidoCentralizado } from '../services/cambioEstadoCentralizado';\nimport type { Pedido } from '../services/pedidoService';\n\n// ============================================================================\n// EJEMPLO 1: Botones de Acci√≥n Simples en una Tabla\n// ============================================================================\n\n/**\n * Uso: Renderizar en una columna de tabla de pedidos\n * Comportamiento: Botones que cambian seg√∫n el estado\n */\nexport function BotonesEstadoTabla({ pedido, onActualizar }: {\n  pedido: Pedido;\n  onActualizar: () => void;\n}) {\n  const { cambiarEstado, cargando, puedeCompletarse, puedeAnularse } = useCambioEstadoPedido({\n    onNotificar: (tipo, msg) => {\n      console.log(`[${tipo}] ${msg}`);\n      // Aqu√≠ ir√≠a tu toast/notificaci√≥n\n    }\n  });\n\n  return (\n    <div className=\"flex gap-2\">\n      {/* BOT√ìN COMPLETAR */}\n      {puedeCompletarse(pedido.estado) && (\n        <button\n          onClick={async () => {\n            await cambiarEstado(pedido.id, 'Completada');\n            onActualizar();\n          }}\n          disabled={cargando}\n          className=\"px-3 py-1 text-sm bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50\"\n        >\n          {cargando ? '‚è≥' : '‚úì'} Completar\n        </button>\n      )}\n\n      {/* BOT√ìN ANULAR */}\n      {puedeAnularse(pedido.estado) && (\n        <button\n          onClick={async () => {\n            await cambiarEstado(pedido.id, 'Anulado');\n            onActualizar();\n          }}\n          disabled={cargando}\n          className=\"px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50\"\n        >\n          ‚úï Anular\n        </button>\n      )}\n    </div>\n  );\n}\n\n// ============================================================================\n// EJEMPLO 2: Card de Detalle con Estado y Acciones\n// ============================================================================\n\n/**\n * Uso: Mostrar detalles de un pedido con barra de estado y acciones\n * Caracter√≠sticas: Badge de estado, descripci√≥n, botones contextuales\n */\nexport function CardDetallePedido({ pedido, onActualizado }: {\n  pedido: Pedido;\n  onActualizado?: (pedidoActualizado: Pedido) => void;\n}) {\n  const {\n    cambiarEstado,\n    cargando,\n    error,\n    exito,\n    limpiarMensajes,\n    puedeEditarse,\n    puedeCompletarse,\n    puedeAnularse,\n    obtenerClaseEstado,\n    obtenerDescripcionEstado,\n    ultimoPedidoActualizado\n  } = useCambioEstadoPedido();\n\n  // Actualizar pedido visible cuando cambia\n  const pedidoMostrado = ultimoPedidoActualizado || pedido;\n\n  const handleCambiarEstado = async (nuevoEstado: Pedido['estado']) => {\n    await cambiarEstado(pedido.id, nuevoEstado);\n    if (ultimoPedidoActualizado) {\n      onActualizado?.(ultimoPedidoActualizado);\n      limpiarMensajes();\n    }\n  };\n\n  return (\n    <div className=\"border rounded-lg p-6 bg-white shadow-sm\">\n      {/* HEADER CON ESTADO */}\n      <div className=\"flex justify-between items-start mb-4\">\n        <div>\n          <h2 className=\"text-xl font-bold\">Pedido {pedidoMostrado.id}</h2>\n          <p className=\"text-gray-600\">Cliente: {pedidoMostrado.clienteId}</p>\n        </div>\n        <span className={`px-3 py-1 rounded text-sm font-medium ${obtenerClaseEstado(pedidoMostrado.estado)}`}>\n          {pedidoMostrado.estado}\n        </span>\n      </div>\n\n      {/* DESCRIPCI√ìN DEL ESTADO */}\n      <p className=\"text-gray-700 mb-4\">\n        ‚ÑπÔ∏è {obtenerDescripcionEstado(pedidoMostrado.estado)}\n      </p>\n\n      {/* DETALLES */}\n      <div className=\"bg-gray-50 p-4 rounded mb-4\">\n        <p><strong>Fecha:</strong> {new Date(pedidoMostrado.fecha).toLocaleDateString('es-ES')}</p>\n        <p><strong>Productos:</strong> {pedidoMostrado.productos.length} items</p>\n        <p><strong>Editable:</strong> {puedeEditarse(pedidoMostrado.estado) ? '‚úì S√≠' : '‚úó No'}</p>\n      </div>\n\n      {/* MENSAJES */}\n      {error && (\n        <div className=\"mb-3 p-3 bg-red-100 text-red-700 rounded\">\n          ‚ùå {error}\n        </div>\n      )}\n      {exito && (\n        <div className=\"mb-3 p-3 bg-green-100 text-green-700 rounded\">\n          ‚úì Cambio realizado exitosamente\n        </div>\n      )}\n\n      {/* BOTONES DE ACCI√ìN */}\n      <div className=\"flex gap-2\">\n        {puedeCompletarse(pedidoMostrado.estado) && (\n          <button\n            onClick={() => handleCambiarEstado('Completada')}\n            disabled={cargando}\n            className=\"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50\"\n          >\n            {cargando ? '‚è≥ Procesando...' : '‚úì Completar Pedido'}\n          </button>\n        )}\n\n        {puedeAnularse(pedidoMostrado.estado) && (\n          <button\n            onClick={() => handleCambiarEstado('Anulado')}\n            disabled={cargando}\n            className=\"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50\"\n          >\n            {cargando ? '‚è≥ Procesando...' : '‚úï Anular Pedido'}\n          </button>\n        )}\n      </div>\n    </div>\n  );\n}\n\n// ============================================================================\n// EJEMPLO 3: Modal para Cambiar Estado\n// ============================================================================\n\n/**\n * Uso: Modal que permite seleccionar el nuevo estado\n * Caracter√≠sticas: Dropdown din√°mico, validaci√≥n integrada\n */\nexport function ModalCambiarEstado({\n  pedido,\n  isOpen,\n  onClose,\n  onExito\n}: {\n  pedido: Pedido;\n  isOpen: boolean;\n  onClose: () => void;\n  onExito?: () => void;\n}) {\n  const [nuevoEstadoSeleccionado, setNuevoEstadoSeleccionado] = useState<Pedido['estado']>(pedido.estado);\n  const {\n    cambiarEstado,\n    cargando,\n    error,\n    puedeCompletarse,\n    puedeAnularse\n  } = useCambioEstadoPedido();\n\n  const handleAplicar = async () => {\n    if (nuevoEstadoSeleccionado === pedido.estado) {\n      onClose();\n      return;\n    }\n    await cambiarEstado(pedido.id, nuevoEstadoSeleccionado);\n    if (!error) {\n      onExito?.();\n      onClose();\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\n      <div className=\"bg-white rounded-lg p-6 max-w-md w-full\">\n        <h2 className=\"text-xl font-bold mb-4\">Cambiar Estado del Pedido</h2>\n\n        <p className=\"text-gray-600 mb-4\">\n          Pedido <strong>{pedido.id}</strong> - Estado actual: <strong>{pedido.estado}</strong>\n        </p>\n\n        {/* SELECTOR DE ESTADO */}\n        <select\n          value={nuevoEstadoSeleccionado}\n          onChange={(e) => setNuevoEstadoSeleccionado(e.target.value as Pedido['estado'])}\n          className=\"w-full px-3 py-2 border rounded mb-4\"\n        >\n          <option value={pedido.estado} disabled>\n            {pedido.estado} (actual)\n          </option>\n          {puedeCompletarse(pedido.estado) && (\n            <option value=\"Completada\">‚Üí Completada</option>\n          )}\n          {puedeAnularse(pedido.estado) && (\n            <option value=\"Anulado\">‚Üí Anulado</option>\n          )}\n        </select>\n\n        {/* ERROR */}\n        {error && (\n          <div className=\"mb-3 p-3 bg-red-100 text-red-700 rounded text-sm\">\n            {error}\n          </div>\n        )}\n\n        {/* BOTONES */}\n        <div className=\"flex gap-2 justify-end\">\n          <button\n            onClick={onClose}\n            disabled={cargando}\n            className=\"px-4 py-2 text-gray-700 border rounded hover:bg-gray-50\"\n          >\n            Cancelar\n          </button>\n          <button\n            onClick={handleAplicar}\n            disabled={cargando || nuevoEstadoSeleccionado === pedido.estado}\n            className=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50\"\n          >\n            {cargando ? 'Procesando...' : 'Aplicar Cambio'}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// ============================================================================\n// EJEMPLO 4: Usar en Servicio (sin React)\n// ============================================================================\n\n/**\n * Uso: En funciones de servicio, eventos, o l√≥gica de negocio\n * Caracter√≠sticas: Promesas, callbacks, manejo de errores\n */\nexport async function procesarCompletacionPedido(\n  pedidoId: string,\n  callbacks?: {\n    onInicio?: () => void;\n    onExito?: (resultado: any) => void;\n    onError?: (error: string) => void;\n  }\n) {\n  try {\n    callbacks?.onInicio?.();\n\n    // Crear venta cuando se completa\n    const crearVenta = async (pedido: Pedido) => {\n      const ventasJson = localStorage.getItem('damabella_ventas') || '[]';\n      const ventas = JSON.parse(ventasJson);\n\n      const nuevaVenta = {\n        id: `vta_${Date.now()}`,\n        pedidoId: pedido.id,\n        clienteId: pedido.clienteId,\n        productos: pedido.productos,\n        total: pedido.productos.reduce((sum, p) => sum + (p.precioVenta * p.cantidad), 0),\n        fecha: new Date().toISOString(),\n        estado: 'Completada'\n      };\n\n      ventas.push(nuevaVenta);\n      localStorage.setItem('damabella_ventas', JSON.stringify(ventas));\n      console.log('‚úì Venta creada:', nuevaVenta.id);\n    };\n\n    // Usar la funci√≥n centralizada\n    const resultado = await cambiarEstadoPedidoCentralizado(\n      pedidoId,\n      'Completada',\n      {\n        onSincronizarVentas: crearVenta,\n        onLog: (nivel, msg) => console.log(`[${nivel}] ${msg}`)\n      }\n    );\n\n    if (resultado.success) {\n      callbacks?.onExito?.(resultado);\n      return resultado;\n    } else {\n      callbacks?.onError?.(resultado.error?.detalle || resultado.mensaje);\n      throw new Error(resultado.mensaje);\n    }\n  } catch (error) {\n    const mensaje = error instanceof Error ? error.message : 'Error desconocido';\n    callbacks?.onError?.(mensaje);\n    throw error;\n  }\n}\n\n// ============================================================================\n// EJEMPLO 5: Hook Personalizado para tu Caso de Uso\n// ============================================================================\n\n/**\n * Uso: Crear un hook personalizado que encapsula tu l√≥gica\n * Ventaja: Reutilizable en m√∫ltiples componentes\n */\nexport function usePedidosManager() {\n  const [pedidos, setPedidos] = useState<Pedido[]>(() => {\n    const stored = localStorage.getItem('damabella_pedidos');\n    return stored ? JSON.parse(stored) : [];\n  });\n\n  const {\n    cambiarEstado,\n    cargando,\n    error,\n    ultimoPedidoActualizado\n  } = useCambioEstadoPedido({\n    // Sincronizar con Ventas\n    onSincronizarVentas: (pedido) => {\n      const ventasJson = localStorage.getItem('damabella_ventas') || '[]';\n      const ventas = JSON.parse(ventasJson);\n      ventas.push({\n        id: `vta_${Date.now()}`,\n        pedidoId: pedido.id,\n        clienteId: pedido.clienteId,\n        productos: pedido.productos,\n        total: pedido.productos.reduce((sum, p) => sum + (p.precioVenta * p.cantidad), 0),\n        fecha: new Date().toISOString()\n      });\n      localStorage.setItem('damabella_ventas', JSON.stringify(ventas));\n    },\n\n    // Notificar cambios\n    onNotificar: (tipo, mensaje) => {\n      console.log(`[${tipo.toUpperCase()}] ${mensaje}`);\n    }\n  });\n\n  // Actualizar state local cuando hay cambios\n  const handleCambiarEstado = async (pedidoId: string, estado: Pedido['estado']) => {\n    await cambiarEstado(pedidoId, estado);\n    if (ultimoPedidoActualizado) {\n      setPedidos(prev =>\n        prev.map(p => p.id === ultimoPedidoActualizado.id ? ultimoPedidoActualizado : p)\n      );\n    }\n  };\n\n  return {\n    pedidos,\n    cargando,\n    error,\n    cambiarEstado: handleCambiarEstado\n  };\n}\n\n// ============================================================================\n// EJEMPLO 6: Acciones Masivas (Cambiar m√∫ltiples pedidos)\n// ============================================================================\n\n/**\n * Uso: Anular o completar varios pedidos de una vez\n * Caracter√≠sticas: Control de progreso, manejo de errores parciales\n */\nexport async function procesarPedidosMasivos(\n  pedidosIds: string[],\n  accion: 'completar' | 'anular',\n  onProgreso?: (actual: number, total: number) => void\n): Promise<{ exitosos: string[]; fallidos: string[] }> {\n  const exitosos: string[] = [];\n  const fallidos: string[] = [];\n\n  const nuevoEstado = accion === 'completar' ? 'Completada' : 'Anulado';\n\n  for (let i = 0; i < pedidosIds.length; i++) {\n    const pedidoId = pedidosIds[i];\n\n    try {\n      const resultado = await cambiarEstadoPedidoCentralizado(\n        pedidoId,\n        nuevoEstado,\n        {\n          continuarSiError: true\n        }\n      );\n\n      if (resultado.success) {\n        exitosos.push(pedidoId);\n      } else {\n        fallidos.push(pedidoId);\n      }\n    } catch (error) {\n      fallidos.push(pedidoId);\n    }\n\n    onProgreso?.(i + 1, pedidosIds.length);\n  }\n\n  return { exitosos, fallidos };\n}\n"